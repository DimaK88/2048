var t={};Object.defineProperty(t,"Game",{get:function(){return e},set:void 0,enumerable:!0,configurable:!0});class e{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.initialState=t,this.score=0,this.state=[...this.initialState],this.status="idle"}moveLeft(){let t=[],e=!1;for(let e=3;e>=0;e--){let s=this.state[e].filter(t=>0!==t);for(let t=1;t<s.length;t++)s[t]===s[t-1]&&(s[t-1]*=2,delete s[t],this.score+=s[t-1]);let i=s.filter(t=>void 0!==t);for(let t=i.length;t<4;t++)i.push(0);t[e]=i}for(let s=0;s<=3;s++)for(let i=0;i<=3;i++)t[s][i]!==this.state[s][i]&&(e=!0);e&&(this.state=t,this.addCell()),this.checkLose(),this.checkWin()}moveRight(){let t=[],e=!1;for(let e=3;e>=0;e--){let s=this.state[e].filter(t=>0!==t);for(let t=s.length-1;t>=0;t--)s[t]===s[t-1]&&(s[t]*=2,s[t-1]=0,this.score+=s[t]);let i=s.filter(t=>0!==t);for(let t=i.length;t<4;t++)i.unshift(0);t[e]=i}for(let s=0;s<=3;s++)for(let i=0;i<=3;i++)t[s][i]!==this.state[s][i]&&(e=!0);e&&(this.state=t,this.addCell()),this.checkLose(),this.checkWin()}moveUp(){this.state=this.turnTable(this.state),this.moveLeft(),this.state=this.turnTable(this.state)}moveDown(){this.state=this.turnTable(this.state),this.moveRight(),this.state=this.turnTable(this.state)}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.status="playing",this.addCell(),this.addCell()}restart(){this.status="idle",this.state=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0}addCell(){let t=Math.random()>.1?2:4,e=0;do{let s=Math.round(3*Math.random()),i=Math.round(3*Math.random());0===this.state[s][i]&&(this.state[s][i]=t,e++)}while(e<1)}turnTable(t){let e=[];for(let s=0;s<=3;s++){let i=[t[0][s],t[1][s],t[2][s],t[3][s]];e.push(i)}return e}checkWin(){for(let t=0;t<=3;t++)for(let e=0;e<=3;e++)2048===this.state[t][e]&&(this.status="win")}checkLose(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.state[t][e]||t<3&&this.state[t][e]===this.state[t+1][e]||e<3&&this.state[t][e]===this.state[t][e+1])return;this.status="lose"}}const s=new(t=e),i=document.querySelector(".controls"),l=document.querySelector(".game-score"),a=document.querySelector(".start"),r=document.querySelector("tbody"),o=document.querySelector(".message-lose"),h=document.querySelector(".message-win"),n=document.querySelector(".message-start"),d=document.createElement("button");function c(){l.textContent=s.getScore();let t=[...r.querySelectorAll(".field-row")];for(let e=0;e<4;e++)for(let i=0;i<4;i++){let l=[...t[e].querySelectorAll(".field-cell")];0===s.getState()[e][i]&&(l[i].textContent=null,l[i].className="field-cell"),0!==s.getState()[e][i]&&(l[i].textContent=s.getState()[e][i],l[i].className="field-cell",l[i].classList.add("field-cell--"+s.getState()[e][i]))}}d.classList.add("restart"),d.classList.add("button"),d.textContent="Restart",a.addEventListener("click",()=>{s.start(),n.classList.add("hidden"),c(),a.remove(),i.append(d)}),d.addEventListener("click",()=>{s.restart(),s.start(),c(),h.classList.add("hidden"),o.classList.add("hidden")}),document.addEventListener("keydown",t=>{"playing"===s.status&&("ArrowLeft"===t.key&&s.moveLeft(),"ArrowRight"===t.key&&s.moveRight(),"ArrowUp"===t.key&&s.moveUp(),"ArrowDown"===t.key&&s.moveDown(),a&&(a.remove(),i.append(d)),"win"===s.status&&h.classList.remove("hidden"),"lose"===s.status&&o.classList.remove("hidden"),c())});
//# sourceMappingURL=index.97e758d0.js.map
